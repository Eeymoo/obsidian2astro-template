---
export interface Props {
  type: 'BlogPosting' | 'WebPage' | 'Article' | 'BreadcrumbList';
  data: Record<string, any>;
}

const { type, data } = Astro.props;

// JSON-LD结构化数据生成器
function generateStructuredData(type: string, data: Record<string, any>) {
  const baseData = {
    "@context": "https://schema.org",
    ...data
  };

  switch (type) {
    case 'BlogPosting':
      return {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "headline": data.title,
        "description": data.description,
        "image": data.image ? [data.image] : undefined,
        "datePublished": data.datePublished,
        "dateModified": data.dateModified || data.datePublished,
        "author": {
          "@type": "Person",
          "name": data.author?.name || "Eeymoo",
          "url": data.author?.url || "https://blog.eeymoo.com"
        },
        "publisher": {
          "@type": "Organization",
          "name": data.publisher?.name || "Eeymoo's Blog",
          "logo": {
            "@type": "ImageObject",
            "url": data.publisher?.logo || "https://blog.eeymoo.com/logo.svg"
          }
        },
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": data.url
        },
        "url": data.url,
        "keywords": data.keywords?.join(', '),
        "inLanguage": data.inLanguage || "zh-CN",
        "isPartOf": {
          "@type": "Blog",
          "@id": data.blogUrl || "https://blog.eeymoo.com/",
          "name": data.blogName || "Eeymoo's Blog"
        }
      };

    case 'WebPage':
      return {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": data.name,
        "description": data.description,
        "url": data.url,
        "lastReviewed": data.lastReviewed,
        "inLanguage": data.inLanguage || "zh-CN",
        "isPartOf": {
          "@type": "WebSite",
          "@id": data.siteUrl || "https://blog.eeymoo.com/",
          "name": data.siteName || "Eeymoo's Blog"
        },
        "breadcrumb": data.breadcrumb
      };

    case 'BreadcrumbList':
      const breadcrumbs = data.items?.map((item: any, index: number) => ({
        "@type": "ListItem",
        "position": index + 1,
        "name": item.name,
        "item": item.url
      }));

      return {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": breadcrumbs
      };

    case 'Article':
      return {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": data.title,
        "description": data.description,
        "image": data.image ? [data.image] : undefined,
        "datePublished": data.datePublished,
        "dateModified": data.dateModified || data.datePublished,
        "author": {
          "@type": "Person",
          "name": data.author?.name || "Eeymoo"
        },
        "publisher": {
          "@type": "Organization",
          "name": data.publisher?.name || "Eeymoo's Blog"
        },
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": data.url
        },
        "url": data.url,
        "keywords": data.keywords?.join(', '),
        "articleSection": data.articleSection,
        "inLanguage": data.inLanguage || "zh-CN"
      };

    default:
      return baseData;
  }
}

const structuredData = generateStructuredData(type, data);
---

<script type="application/ld+json" set:html={JSON.stringify(structuredData, null, 2)}></script>