---
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";
import StructuredData from "../components/StructuredData.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../consts";
import { getCollection, render } from "astro:content";
import { filterContent } from "../utils";
import "../styles/global.css";



// è·å–æœ€æ–°ä¸€æ¡microblog
const allMicroblogs = filterContent(await getCollection("blog"), 'microblog')
  .sort((a, b) => b.data.date?.valueOf() - a.data.date?.valueOf());

const latestMicroblog = allMicroblogs.length > 0 ? allMicroblogs[0] : null;
const latestMicroblogHtml = latestMicroblog ? await render(latestMicroblog) : null;

// é¦–é¡µç»“æ„åŒ–æ•°æ®
const homepageStructuredData = {
  "@type": "WebSite",
  name: SITE_TITLE,
  description: SITE_DESCRIPTION,
  url: Astro.url.origin,
  inLanguage: "zh-CN",
  potentialAction: {
    "@type": "SearchAction",
    target: `${Astro.url.origin}/search/?q={search_term_string}`,
    "query-input": "required name=search_term_string"
  }
};

// Speculation Rules: hint important navigation paths for faster page loads
const speculationUrls = [
  "/post",           // Blog post listing page
  "/categories",     // Categories listing
  "/tags",           // Tags listing
  "/archives",       // Archives page
];
if (allMicroblogs.length > 0) {
  speculationUrls.push("/microblog");
}
---

<!doctype html>
<html lang="zh-CN" class="scroll-smooth">
  <head>
    <BaseHead 
      title={SITE_TITLE} 
      description={SITE_DESCRIPTION}
      keywords={["æŠ€æœ¯åšå®¢", "ç¼–ç¨‹", "JavaScript", "TypeScript", "Vue", "React", "å‰ç«¯å¼€å‘", "åç«¯å¼€å‘"]}
      speculationUrls={speculationUrls}
      speculationEagerness="moderate"
    />
    <StructuredData type="WebPage" data={homepageStructuredData} />
    <script>
      // é˜²æ­¢é—ªçƒï¼šåœ¨é¡µé¢åŠ è½½å‰è®¾ç½®ä¸»é¢˜
      const savedTheme = localStorage.getItem("theme");
      const prefersDark = window.matchMedia(
        "(prefers-color-scheme: dark)",
      ).matches;
      const isDark = savedTheme === "dark" || (!savedTheme && prefersDark);
      if (isDark) {
        document.documentElement.classList.add("dark");
      }
    </script>
  </head>
  <body>
    <Header />
    <main class="w-full h-[calc(100vh-56px)] max-w-4xl mx-auto p-8">
      <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">
        Hi Everyone <span class="text-5xl inline-block animate-wave">ğŸ‘‹</span
        ><br /> I'm
        <span class="text-primary bg-clip-text font-extrabold">Eeymoo</span
        >(<span class="text-2xl text-slate-800 dark:text-slate-200"
          >/ËˆiËmuË/</span
        >).
      </h1>
      <br />
      <style>
        @keyframes wave {
          0% {
            transform: rotate(0deg);
          }
          10% {
            transform: rotate(14deg);
          }
          20% {
            transform: rotate(-8deg);
          }
          30% {
            transform: rotate(14deg);
          }
          40% {
            transform: rotate(-4deg);
          }
          50% {
            transform: rotate(10deg);
          }
          60% {
            transform: rotate(0deg);
          }
          100% {
            transform: rotate(0deg);
          }
        }
        .animate-wave {
          animation: wave 2.5s ease-in-out infinite;
          transform-origin: 70% 70%;
          display: inline-block;
        }
      </style>
      <p class="text-lg text-gray-700 dark:text-gray-300 mb-6">
        I like Markdown and JavaScript.
      </p>
      <p class="text-lg text-gray-700 dark:text-gray-300 mb-6">
        I can develop
        <img
          class="h-4! inline-block!"
          src="https://cdn.simpleicons.org/typescript?viewbox=auto"
          alt="TypeScript"
        />
        <span>TS</span>
        <img
          class="h-4! inline-block!"
          src="https://cdn.simpleicons.org/javascript?viewbox=auto"
          alt="JavaScript"
        />
        <span>JS</span>
        <img
          class="h-4! inline-block!"
          src="https://cdn.simpleicons.org/css?viewbox=auto"
          alt="CSS"
        />
        <span>CSS</span>
        <img
          class="h-4! inline-block!"
          src="https://cdn.simpleicons.org/vue.js?viewbox=auto"
          alt="Vue"
        />
        <span>Vue</span>
        <img
          class="h-4! inline-block!"
          src="https://cdn.simpleicons.org/react?viewbox=auto"
          alt="React"
        />
        <span>React</span>
      </p>
      <p class="text-lg text-gray-700 dark:text-gray-300 mb-6">
        I can use
        <img
          class="h-4! inline-block!"
          src="https://cdn.simpleicons.org/python?viewbox=auto"
          alt="Python"
        />
        <span>Python</span>
      </p>
      <p class="text-lg text-gray-700 dark:text-gray-300 mb-6">
        So I only know a little bit. But we can look up Python documentation
        anywhere.
      </p>
      <p class="text-lg text-gray-700 dark:text-gray-300 mb-6">
        The editor I have been using for the longest time is vscode, and I have
        also been learning vim recently.
      </p>
      <div class="flex space-x-2 mb-6">
        <img
          class="h-6!"
          src="https://cdn.simpleicons.org/typescript?viewbox=auto"
          alt="TypeScript"
        />
        <img
          class="h-6!"
          src="https://cdn.simpleicons.org/javascript?viewbox=auto"
          alt="JavaScript"
        />
        <img
          class="h-6!"
          src="https://cdn.simpleicons.org/css?viewbox=auto"
          alt="CSS"
        />
        <img
          class="h-6!"
          src="https://cdn.simpleicons.org/vue.js?viewbox=auto"
          alt="Vue"
        />
        <img
          class="h-6!"
          src="https://cdn.simpleicons.org/react?viewbox=auto"
          alt="React"
        />
        <img
          class="h-6!"
          src="https://cdn.simpleicons.org/python?viewbox=auto"
          alt="Python"
        />
        <img
          class="h-6!"
          src="https://cdn.simpleicons.org/rss?viewbox=auto"
          alt="RSS"
        />
        <img
          class="h-6!"
          src="https://cdn.simpleicons.org/ubuntu?viewbox=auto"
          alt="Ubuntu"
        />
        <img
          class="h-6!"
          src="https://cdn.simpleicons.org/debian?viewbox=auto"
          alt="Debian"
        />
        <img
          class="h-6!"
          src="https://cdn.simpleicons.org/rust?viewbox=auto"
          alt="Rust"
        />
      </div>
      {
        latestMicroblog && latestMicroblogHtml && (
          <div class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-700">
            <h2 class="text-xl font-bold text-gray-900 dark:text-white mb-4">
              Latest Microblog
            </h2>
            <div class="mb-2 text-sm text-gray-400 dark:text-gray-500">
              {latestMicroblog.data.date && new Date(latestMicroblog.data.date).toLocaleString('zh-CN')}
            </div>
            <div class="text-base prose dark:prose-invert max-w-none text-gray-600 dark:text-gray-300">
              <latestMicroblogHtml.Content />
            </div>
            <a href="/microblog/" class="mt-4 inline-block text-blue-600 dark:text-blue-400 hover:underline text-sm">
              æŸ¥çœ‹æ›´å¤š â†’
            </a>
          </div>
        )
      }
    </main>
    <Footer />
  </body>
</html>
